<!DOCTYPE html>
<html>
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <link type="text/css" rel="stylesheet" href="css/materialize.min.css"  media="screen,projection"/>
  <link type="text/css" rel="stylesheet" href="css/styles.css"  media="screen,projection"/>
</head>
<body>

  <header class="site-header cyan"></header><!-- /.site-header -->

	<div class="site-container container">
		<div class="row">
      <div class="col s12">
        <div class="card">
          <div class="card-image">
            <img src="img/friend-finder-3.jpg">
            <span class="card-title text-uppercase">Friend Finder</span>
          </div><!-- /.card-image -->

          <form id="form" action="/api/friends" method="POST"></form>
            <div class="card-content">
              
              <p>Answer each question below with <strong>1 Being Strongly Disagree</strong> and <strong>5 Being Strongly Agree</strong>.</p>

              <div class="row">
                <div class="input-field col s6">
                  <i class="material-icons prefix">account_circle</i>
                  <input id="name" name="name" type="text" class="validate" required="" aria-required="true">
                  <label for="name">Name</label>
                </div><!--/.input -->
                <div class="input-field col s6">
                  <i class="material-icons prefix">add_a_photo</i>
                  <input id="photo" name="photo" type="text" class="validate" required="" aria-required="true">
                  <label for="photo">Photo</label>
                </div><!--/.input -->
              </div><!--/.row -->

              <div class="row">
                <div class="input-field col s6">
                  <select id="option_1" name="option_1" class="validate" required="" aria-required="true">
                    <option value="" disabled selected>Choose your option</option>
                    <option value="1">1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5</option>
                  </select>
                  <label>Do You like Sports?</label>
                </div><!--/.input -->

                <div class="input-field col s6">
                  <select id="option_2" name="option_2" class="validate" required="" aria-required="true">
                    <option value="" disabled selected>Choose your option</option>
                    <option value="1">1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5</option>
                  </select>
                  <label>Do You like long walks on the Beach?</label>
                </div><!--/.input -->

                <div class="input-field col s6">
                  <select id="option_3" name="option_3" class="validate" required="" aria-required="true">
                    <option value="" disabled selected>Choose your option</option>
                    <option value="1">1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5</option>
                  </select>
                  <label>Do You like Mondays?</label>
                </div><!--/.input -->

                <div class="input-field col s6">
                  <select id="option_4" name="option_4" class="validate" required="" aria-required="true">
                    <option value="" disabled selected>Choose your option</option>
                    <option value="1">1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5</option>
                  </select>
                  <label>Do You like Peanut Butter?</label>
                </div><!--/.input -->

                <div class="input-field col s6">
                  <select id="option_5" name="option_5" class="validate" required="" aria-required="true">
                    <option value="" disabled selected>Choose your option</option>
                    <option value="1">1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5</option>
                  </select>
                  <label>Do You like the TV Show Game of Thrones?</label>
                </div><!--/.input -->

                <div class="input-field col s6">
                  <select id="option_6" name="option_6" class="validate" required="" aria-required="true">
                    <option value="" disabled selected>Choose your option</option>
                    <option value="1">1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5</option>
                  </select>
                  <label>Do You like Sunsets?</label>
                </div><!--/.input -->

                <div class="input-field col s6">
                  <select id="option_7" name="option_7" class="validate" required="" aria-required="true">
                    <option value="" disabled selected>Choose your option</option>
                    <option value="1">1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5</option>
                  </select>
                  <label>Do You like the Rain?</label>
                </div><!--/.input -->

                <div class="input-field col s6">
                  <select id="option_8" name="option_8" class="validate" required="" aria-required="true">
                    <option value="" disabled selected>Choose your option</option>
                    <option value="1">1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5</option>
                  </select>
                  <label>Do You like Summer?</label>
                </div><!--/.input -->

                <div class="input-field col s6">
                  <select id="option_9" name="option_9" class="validate" required="" aria-required="true">
                    <option value="" disabled selected>Choose your option</option>
                    <option value="1">1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5</option>
                  </select>
                  <label>Do You Like Traveling?</label>
                </div><!--/.input -->

                <div class="input-field col s6">
                  <select id="option_10" name="option_10" class="validate" required="" aria-required="true">
                    <option value="" disabled selected>Choose your option</option>
                    <option value="1">1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5</option>
                  </select>
                  <label>Do you like to Exercise?</label>
                </div><!--/.input -->
              </div><!--/.row -->
              
            </div><!-- /.card-content -->
            <div class="card-action">
              <button id="btn-submit" type="submit" class="waves-effect waves-light btn cyan lighten-1"><i class="material-icons right">arrow_forward</i> Submit Survey</button>
            </div><!-- /.card-action -->
          </form>
        </div><!-- /.card -->  
      </div><!-- /.col -->  
		</div><!-- /.row -->
  </div><!-- /.container -->

  <div id="modal" class="modal">
    <div class="modal-content">
      <h4>Top Match</h4>
      <img id="best-match-img" src="" width="400">
      <h4 id="best-match-name"></h4>
    </div><!-- /.modal-content -->
    <div class="modal-footer">
     <a href="#!" class="modal-action modal-close waves-effect waves-green btn-flat">Close</a>
    </div>
  </div><!-- /.modal -->

  <footer class="page-footer cyan">
    <div class="footer-copyright">
      <div class="container">
        &copy; 2017 Friend Finder, All rights reserved.
        <a class="grey-text text-lighten-4 right" href="http://www.mariomelchor.com">Designed By mariomelchor.com</a>
      </div><!-- /.container -->
    </div><!--/.footer-copyright -->
  </footer><!--/.page-footer -->

  <script type="text/javascript" src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
  <script type="text/javascript" src="js/materialize.min.js"></script>
  <script>
    $(document).ready(function() {
      $('select').material_select();
      $('.modal').modal();

      // when the search button executed
      $('#btn-submit').on("click", function(event) {
        event.preventDefault();

        // far for select fields
        var val = [];

        // gets all select field values and adds to array
        $('select').each(function(){
          var number = $(this).val();
          val.push(number);
        });
      
        var answers = {
          name:  $('#name').val().trim(),
          photo: $('#photo').val().trim(),
          scores: val
        }

        // Post using AJAX
        $.post('/api/friends', answers).done(function(data) {

          // Gets Besth Match and append to Dom Opens Modal
          $('#best-match-name').text(data.name);
          $('#best-match-img').attr('src',data.photo);
          $('#modal').modal('open');

          // Clear out form values
          $('#name').val('');
          $('#photo').val('');
          $('select').each(function(){
            $(this).val('');
            $(this).prop('selectedIndex', 0); //Sets the first option as selected
            $(this).material_select();        //Update material select
          });

        });

      });
    });
  </script>
</body>
</html>
